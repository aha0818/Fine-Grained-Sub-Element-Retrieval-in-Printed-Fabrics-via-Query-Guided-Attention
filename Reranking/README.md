# Reranking Module
The Reranking module is the second and final stage of the two-stage fine-grained sub-element retrieval framework. It leverages a query-guided attention mechanism to refine the preliminary candidate list generated by the Initial Retrieval module, focusing on sub-element-level local semantics and suppressing irrelevant background information to improve retrieval accuracy.
# Overview
While the initial retrieval narrows down potential candidates using global features, it may still include images with similar overall appearances but mismatched sub-elements. The reranking module addresses this by:

1. Dynamically allocating attention to sub-element regions in candidate images, guided by the query sub-element.

2. Suppressing interference from irrelevant background patterns or non-target sub-elements.

3. Recomputing similarity scores based on fine-grained local features aligned with the query semantics.

This stage transforms the rough initial ranking into a precise result, ensuring that the top candidates truly contain the target sub-element, which is critical for industrial applications like printed fabric retrieval.
# Usage
1. Prepare Inputs

   **-Initial Retrieval Results**: The primary input is the ranked candidate list from the `Initial Retrieval` module.

   **-Query Sub-elements**: Path to query images.

   **-Candidate Images**: The fabric images corresponding to the initial candidates.
   
3. Configure Parameters
   
4. Run Reranking
   
   -Execute `Query_guided_attention_training.ipynb` for query-guided attention module training.

   -Execute `Query_guided_attention_reranking_and_evaluate.ipynb` for query-guided attention module evaluation and initial retrieval results reranking.

# Output
The reranked results are saved in `Output/`, with the following structure:

**-query_path**: Path to query sub-element.

**-retrieved_path**: Path to retrieved images.

**-similarity_score**: Similarity score after attention-based refinement.
